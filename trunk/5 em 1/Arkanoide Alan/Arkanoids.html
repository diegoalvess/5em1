<!DOCTYPE HTML>

<html>

	<head>
	
		<title>
		Tarkanoid
		</title>
	
<script src="js/Tijolo Cinza.js"></script>
<script src="js/Tijolo Amarelo.js"></script>
<script src="js/Tijolo Verde.js"></script>
<script src="js/Tijolo Vermelho.js"></script>	
<script src="js/Paleta.js"></script>
<script src="js/Ball.js"></script>		
	
	</head>
	
	<center>
	<body>
		
	<canvas width="800" height="1100" id="main" style="border:1px solid #000000;"></canvas>
	<canvas width="224" height="1100" id="main2" style="border:10px solid #000000;"></canvas>
	

		<script>
		
		var canvas = document.getElementById("main");
		var screen = canvas.getContext("2d");
		
		
		var canvas2 = document.getElementById("main2");
		var screen2 = canvas2.getContext("2d");

		//VARIAVEL AONDE O JOGO ACONTECE//
		var campo = new Image();
		var campo_carregada = false;
		var campo_w = 800;
		var campo_h = 1100;
	
	
		//VARIAVEL DO CAMPO DA DIREITA//
		var campo_direita = new Image();
		var campo_direita_carregada = false;
		var campo_direita_w = 224 ; 
		var campo_direita_h = 1100;
		var campo_direita_posicao_x = 2;
		var campo_direita_posicao_y = 2;


		//ESTA TUDO NA CLASSE DA PALETA//
		var jogador = new Paleta();
		
		//VARIAVEL PARA MEXER COM AS SETAS//
		var direita = false;
		var	esquerda = false;
		
		//VARIAVEL E LISTA DO TIJOLO CINZA//
		
			var tijolo_cinza = new Array();
		
		tijolo_cinza[0] = new Tijolo_Cinza(); 
		tijolo_cinza[1] = new Tijolo_Cinza();
		tijolo_cinza[2] = new Tijolo_Cinza();
		tijolo_cinza[3] = new Tijolo_Cinza();
		tijolo_cinza[4] = new Tijolo_Cinza();
		tijolo_cinza[5] = new Tijolo_Cinza();
		tijolo_cinza[6] = new Tijolo_Cinza();
		tijolo_cinza[7] = new Tijolo_Cinza();
		tijolo_cinza[8] = new Tijolo_Cinza();
		tijolo_cinza[9] = new Tijolo_Cinza();
		tijolo_cinza[10] = new Tijolo_Cinza();

		tijolo_cinza[0].posicao_x = 50;
		tijolo_cinza[1].posicao_x = 113;
		tijolo_cinza[2].posicao_x = 176;
		tijolo_cinza[3].posicao_x = 242;
		tijolo_cinza[4].posicao_x = 308;
		tijolo_cinza[5].posicao_x = 374;
		tijolo_cinza[6].posicao_x = 437;
		tijolo_cinza[7].posicao_x = 502;
		tijolo_cinza[8].posicao_x = 565;
		tijolo_cinza[9].posicao_x = 628;
		tijolo_cinza[10].posicao_x = 693;
		
		//VARIAVEL E LISTA DO TIJOLO AMARELO//
		
		var tijolo_amarelo = new Array();
		
		tijolo_amarelo[0] = new Tijolo_Amarelo();
		tijolo_amarelo[1] = new Tijolo_Amarelo();
		tijolo_amarelo[2] = new Tijolo_Amarelo();
		tijolo_amarelo[3] = new Tijolo_Amarelo();
		tijolo_amarelo[4] = new Tijolo_Amarelo();
		tijolo_amarelo[5] = new Tijolo_Amarelo();
		tijolo_amarelo[6] = new Tijolo_Amarelo();
		tijolo_amarelo[7] = new Tijolo_Amarelo();
		tijolo_amarelo[8] = new Tijolo_Amarelo();
		
		tijolo_amarelo[0].posicao_x = 115;
		tijolo_amarelo[1].posicao_x = 178;
		tijolo_amarelo[2].posicao_x = 244;
		tijolo_amarelo[3].posicao_x = 310;
		tijolo_amarelo[4].posicao_x = 376;
		tijolo_amarelo[5].posicao_x = 439;
		tijolo_amarelo[6].posicao_x = 504;
		tijolo_amarelo[7].posicao_x = 567;
		tijolo_amarelo[8].posicao_x = 630;
		
		//VARIAVEL E LISTA DO TIJOLO VERDE//
		
		var tijolo_verde = new Array();
		
		tijolo_verde[0] = new Tijolo_Verde();
		tijolo_verde[1] = new Tijolo_Verde();
		tijolo_verde[2] = new Tijolo_Verde();
		tijolo_verde[3] = new Tijolo_Verde();
		tijolo_verde[4] = new Tijolo_Verde();
		tijolo_verde[5] = new Tijolo_Verde();
		tijolo_verde[6] = new Tijolo_Verde();
		
		tijolo_verde[0].posicao_x = 180;
		tijolo_verde[1].posicao_x = 246;
		tijolo_verde[2].posicao_x = 312;
		tijolo_verde[3].posicao_x = 378;
		tijolo_verde[4].posicao_x = 441;
		tijolo_verde[5].posicao_x = 506;
		tijolo_verde[6].posicao_x = 569;
		
		//VARIAVEL E LISTA DO TIJOLO VERMELHO//
		
		var tijolo_vermelho = new Array();
		
		tijolo_vermelho[0] = new Tijolo_Vermelho();
		tijolo_vermelho[1] = new Tijolo_Vermelho();
		tijolo_vermelho[2] = new Tijolo_Vermelho();
		tijolo_vermelho[3] = new Tijolo_Vermelho();
		tijolo_vermelho[4] = new Tijolo_Vermelho();
		
		tijolo_vermelho[0].posicao_x = 248;
		tijolo_vermelho[1].posicao_x = 314;
		tijolo_vermelho[2].posicao_x = 380;
		tijolo_vermelho[3].posicao_x = 443;
		tijolo_vermelho[4].posicao_x = 508;
		
		
		//VARIAVEL PELA CLASSE DA BOLA, BALL//
		var  bola = new Ball(); 


Load();



function Load ()

{
	campo.src ="imagens/fundo.png";
	campo.onload = function()
	{
		campo_carregada = true;
		console.log ("campo_carregou");
	}
	
	campo_direita.src ="imagens/fundo2.png";
	campo_direita.onload = function()
	{
		campo_direita_carregada = true;
		console.log("campo_direita_carregou");
	}
	
	
	

	if(campo_carregada&&campo_direita_carregada)
	{
		Loop();
	}
	else
	{
		setTimeout(Load, 30 );
	}
}




function Update ()
{
	console.log("Update");


	jogador.update();

	bola.update(jogador.posicao_x+jogador.largura_w/2);

	if(Collide(
			bola.posicao_x,
			bola.posicao_y,
			bola.size_x,
			bola.size_y,
			jogador.posicao_x,
			jogador.posicao_y,
			jogador.largura_w,
			jogador.altura_h))
			{
			bola.velocidade_y *=-1;
		    }
			
		for(var i = 0; i < tijolo_cinza.length; i++)
		{
			
			if(tijolo_cinza[i].visible)
			{
				if(Collide(
				bola.posicao_x,
				bola.posicao_y,
				bola.size_x,
				bola.size_y,
				tijolo_cinza[i].posicao_x,
				tijolo_cinza[i].posicao_y,
				tijolo_cinza[i].tamanho_w,
				tijolo_cinza[i].tamanho_h))
			
				{
					bola.velocidade_y *= -1;
					tijolo_cinza[i].visible = false;
				}
		
			}
		} 

	for(var i2 = 0; i2 < tijolo_amarelo.length; i2++)
		{
			
			if(tijolo_amarelo[i2].visible)
			{
				if(Collide(
				bola.posicao_x,
				bola.posicao_y,
				bola.size_x,
				bola.size_y,
				tijolo_amarelo[i2].posicao_x,
				tijolo_amarelo[i2].posicao_y,
				tijolo_amarelo[i2].tamanho_w,
				tijolo_amarelo[i2].tamanho_h))
			
				{
					bola.velocidade_y *= -1;
					tijolo_amarelo[i2].visible = false;
				}

			}

		}
		
		for(var i3 = 0; i3 < tijolo_verde.length; i3++)
		{
			
			if(tijolo_verde[i3].visible)
			{
				if(Collide(
				bola.posicao_x,
				bola.posicao_y,
				bola.size_x,
				bola.size_y,
				tijolo_verde[i3].posicao_x,
				tijolo_verde[i3].posicao_y,
				tijolo_verde[i3].tamanho_w,
				tijolo_verde[i3].tamanho_h))
			
				{
					bola.velocidade_y *= -1;
					tijolo_verde[i3].visible = false;
				}

			}

		}
		
		
		for(var i4 = 0; i4 < tijolo_vermelho.length; i4++)
		{
			
			if(tijolo_vermelho[i4].visible)
			{
				if(Collide(
				bola.posicao_x,
				bola.posicao_y,
				bola.size_x,
				bola.size_y,
				tijolo_vermelho[i4].posicao_x,
				tijolo_vermelho[i4].posicao_y,
				tijolo_vermelho[i4].tamanho_w,
				tijolo_vermelho[i4].tamanho_h))
			
				{
					bola.velocidade_y *= -1;
					tijolo_vermelho[i4].visible = false;
				}

			}

		}
		
}	




function Draw ()
{
	console.log("Draw");
	//CAMPO DO  JOGO//
	screen.drawImage(campo,0,0);
	
	//CAMPO DA DIREITA//
	screen2.drawImage(campo_direita,campo_direita_posicao_x,campo_direita_posicao_y);
	
	//CLASSE DA PALETA//
	screen.drawImage(jogador.img, jogador.posicao_x, jogador.posicao_y);
	
	//CLASSE DO TIJOLO CINZA//
	
	for(var i = 0; i < tijolo_cinza.length; i++)
      {
		 if(tijolo_cinza[i].visible)
        {
			screen.drawImage(tijolo_cinza[i].img, tijolo_cinza[i].posicao_x, tijolo_cinza[i].posicao_y);
        }
      }	
      
      //CLASSE DO TIJOLO AMARELO//
      
    for(var i2 = 0; i2 < tijolo_amarelo.length; i2++)
      
      {
		if(tijolo_amarelo[i2].visible)
        screen.drawImage(tijolo_amarelo[i2].img, tijolo_amarelo[i2].posicao_x, tijolo_amarelo[i2].posicao_y);
        
      }	
      
      //CLASSE DO TIJOLO VERDE//
      
    for(var i3 = 0; i3 < tijolo_verde.length; i3++)
    
      {
		if(tijolo_verde[i3].visible)
        screen.drawImage(tijolo_verde[i3].img, tijolo_verde[i3].posicao_x, tijolo_verde[i3].posicao_y);
        
      }
      
      //CLASSE DO TIJOLO VERMELHO//
      
    for(var i4 = 0; i4 < tijolo_vermelho.length; i4++)	
      
      {
		if(tijolo_vermelho[i4].visible)
        screen.drawImage(tijolo_vermelho[i4].img, tijolo_vermelho[i4].posicao_x, tijolo_vermelho[i4].posicao_y);
        
      }	
	
		//CLASSE DA BOLA,BALL//
		screen.drawImage(bola.img,bola.posicao_x,bola.posicao_y);

}





function Loop ()
{

	Update();

	Draw();

	setTimeout(Loop, 30 );
}


//FAZENDO SE MEXER COM AS SETAS DO TECLADO//	
	window.addEventListener("keydown",key_down,true);
	window.addEventListener("keyup",key_up,true);
	
function key_down(key)
	{
		console.log(key.keyCode);
		
		if(key.keyCode == 39) //direita//
		{
			direita = true;
			
		}	
		
		if (key.keyCode == 37) //esquerda/
		{
			esquerda = true;
				
		}
		
		if(key.keyCode == 32)
		{
			bola.followplayer = false;
			
		}
	
	}
	
	
function key_up(key)
	{
			console.log(key.keyCode);
			
		if(key.keyCode == 39)//direita
		{
			direita = false;	
		}
		
		if(key.keyCode == 37)//esquerda
		{
			esquerda = false;
		}
	}

function Collide(x1,y1,w1,h1,x2,y2,w2,h2)
{
		if ((x1+w1<x2)
			||(x1>x2+w2)
			||(y1+h1<y2)
			||(y1>y2+h2))
			
			{
				return false; //nao clidiu//
			}
			else
			{
				return true;//colidiu
			}
}


		</script>

	</body>

	</center>
</html>